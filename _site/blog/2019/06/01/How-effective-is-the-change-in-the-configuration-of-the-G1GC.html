<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Kellin's daily life...</title>
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link href="/kudos.css" media="screen" rel="stylesheet" type="text/css" />
  </head>
  <body>


  <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
<script src="/assets/js/functions.js"></script>
<script src="/assets/js/main.js"></script>
<script src="/assets/js/modernizr.js"></script>
<script src="/assets/js/kudos.js"></script>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-70467029-1', 'auto');
    ga('send', 'pageview');

</script>

<a href="#" class="back-to-top">Back To Top</a><div id="container" class="logo"></div><header id="h_small"><nav id="nav_small"><a href="/#about-me">About Me</a><a href="/#Experenice">Experience</a><a href="/#Blog">Blog</a><a href="/#Details">Contact Me</a></nav></header>


<script type="text/javascript">
			// needs to be a string for jquery.cookie
			var postId = '1';
			$(function()
			{
				// initialize kudos
				$("figure.kudoable").kudoable();
				// check to see if user has already kudod
				// fyi cookies do not work when you are viewing this as a file
				if($.cookie(postId) == 'true') {
					// make kudo already kudod
					$("figure.kudoable").removeClass("animate").addClass("complete");
					// your server would take care of the proper kudos count, but because this is a
					// static page, we need to set it here so it doesn't become -1 when you remove
					// the kudos after a reload
					$(".num").html(1);
				}
				// when kudoing
				$("figure.kudo").bind("kudo:active", function(e)
				{
					console.log("kudoing active");
				});
				// when not kudoing
				$("figure.kudo").bind("kudo:inactive", function(e)
				{
					console.log("kudoing inactive");
				});
				// after kudo'd
				$("figure.kudo").bind("kudo:added", function(e)
				{
					var element = $(this);
					// ajax'y stuff or whatever you want
					console.log("Kodo'd:", element.data('id'), ":)");
					// set cookie so user cannot kudo again for 7 days
					$.cookie(postId, 'true', { expires: 7 });
				});
				// after removing a kudo
				$("figure.kudo").bind("kudo:removed", function(e)
				{
					var element = $(this);
					// ajax'y stuff or whatever you want
					console.log("Un-Kudo'd:", element.data('id'), ":(");
					// remove cookie
					$.removeCookie(postId);
				});
			});
		</script>



<div class="post-header">
  <h1 class="post-title">How effective is the change in the configuration of the G1GC?</h1>
</div>
<div class="post-header">
  <p class="post-meta">June 1, 2019 — 23:00</p>
</div>

<div class="post-wrapper">



  <article class="post-content">
    <div class = "blurb-blog">
    <p>In general, the Developer says not to modify the JVM options, <br />
to the exclusion of the Heap memory part.</p>

<p>Especially, at the turn of the JDK8, the G1GC shows better <br />
performance than the another GC. <br /></p>

<p>Because of that performance, We don’t think need tuning of the GC options. <br />
But sometimes, It may be good to try the GC tuning. <br /></p>

<p><img src="https://user-images.githubusercontent.com/4101636/58749946-017f7780-84c7-11e9-8b59-bc27eb4c4aa6.png" alt="image" width="100%" /></p>

<p>You are already have known about the G1GC, let see this picture. <br /></p>

<p>The G1GC structure is similar to the chessboard. <br />
The area divided like a chessboard is called the region. <br />
The region status is to change to the Eden, Survivor, Old <br /> 
and that default size is allocated the Max Heap size divided by 2048. <br /></p>

<p>if generate Object over that value (<b>max heap / 2048</b>) in the Heap memory, <br /> 
Objects are stored in the partitioned Region area. <br /></p>

<p>Of course, Big Object (over than 50% of the region size) is stored <br />
in the Humongous area, But it is very slow.<br /></p>

<p>I will introduce my case. <br /></p>

<p>My Application is handling encoded image data by base64 <br /> 
and it is over 6M per request. <br /></p>

<p>First, set it to 8GB Heap memory by default.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">-Xms8G</span> 
<span class="nt">-Xmx8G</span>
</code></pre></div></div>

<p>I compared the general options with the changed region sizes <b>for a day</b>. (with few options) <br /></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">-XX</span>:G1HeapRegionSize<span class="o">=</span>n
<span class="nt">-XX</span>:InitiatingHeapOccupancyPercent<span class="o">=</span>n
<span class="nt">-XX</span>:G1ReservePercent<span class="o">=</span>n
</code></pre></div></div>

<p><b>Heap Memory</b></p>
<ol>
  <li>Basic options.
<img src="https://user-images.githubusercontent.com/4101636/58750546-d436c780-84ce-11e9-970c-bd8f5ff1a969.png" alt="image" width="100%" /></li>
  <li>Changed options.
<img src="https://user-images.githubusercontent.com/4101636/58750592-558e5a00-84cf-11e9-876a-8180afce9eb8.png" alt="image" width="100%" /></li>
</ol>

<p>The usage of the Heap memory is decreased at a peak time.</p>

<p><b>GC Time</b></p>
<ol>
  <li>Basic options.
<img src="https://user-images.githubusercontent.com/4101636/58750677-6390aa80-84d0-11e9-8652-42d9f3e2b82b.png" alt="image" width="100%" /></li>
  <li>Changed options.
<img src="https://user-images.githubusercontent.com/4101636/58750691-95a20c80-84d0-11e9-9edb-1b9d7f8ebf4c.png" alt="image" width="100%" /></li>
</ol>

<p>The GC time is about 50 percent faster.</p>

<p><b>G1 Collection Phases statics</b></p>
<ol>
  <li>Basic options.
<img src="https://user-images.githubusercontent.com/4101636/58750813-b454d300-84d1-11e9-8b0d-e7a1cddb086b.png" alt="image" width="100%" /></li>
  <li>Changed options.
<img src="https://user-images.githubusercontent.com/4101636/58750838-dea69080-84d1-11e9-9de0-7a66298ffa27.png" alt="image" width="100%" /></li>
</ol>

<p>Because of One object was stored in one region, <br />
the FullGC(Long Stop-The-World) doesn’t occur because the GC affects only <br />
one the region when GC occurs. <br /></p>

<p><b>this is my speculation.</b></p>

<p>My conclusion is that you have a large memory size to handle per request.<br />
We have to try it.</p>


   </div>
  </article>


</div>
<div class="comment">
  
  </div>

  <footer><div class="lockup"><div class="content-wrap"><nav><a href="#about-me">About Me</a><a href="#Experenice">Experience</a><a href="#Blog">Blog</a><a href="#Details">Contact Me</a></nav><p class="copyright">kellin 2018</p></div></div></footer>
  </body>
</html>
